// Apex Meta-Architect Database Schema v3.0

Table prompts {
  id integer [primary key]
  text text [not null]
  Q_score float [not null]
  parent_id integer [null] // Lineage tracking
  version integer [default: 1]
  created_at timestamp [default: `now()`]
  deleted_at timestamp [null]

  Indexes {
    Q_score
    created_at
    parent_id
  }
}

Table variants {
  id integer [primary key]
  prompt_id integer
  type text // enum: concise, neutral, commanding
  text text
  Q_score float
  features jsonb // PES breakdown
}

Table tags {
  id integer [primary key]
  name text [unique]
}

Table prompt_tags {
  prompt_id integer
  tag_id integer
}

Table versions {
  id integer [primary key]
  prompt_id integer
  text text
  Q_score float
  created_at timestamp
}

Ref: prompts.parent_id > prompts.id
Ref: variants.prompt_id > prompts.id
Ref: prompt_tags.prompt_id > prompts.id
Ref: prompt_tags.tag_id > tags.id
Ref: versions.prompt_id > prompts.id
