graph TB
    subgraph "APEX Client Layer [Target Latency: <100ms]"
        Browser[Web Browser]
        Mobile[Mobile Client]
    end

    subgraph "Frontend - React 18 / TS [TIER-1]"
        LibraryView[Library View<br/>Virtual Grid + Paginated Fetch]
        EditorView[Editor View<br/>Debounced Q-Engine]
        AnalyzerView[Analyzer View<br/>Parallel A/B/C Processing]
        ReportsView[Advanced Analytics<br/>Recharts + Time-Aggregations]

        Components[Apex Components<br/>PromptCard (Memoized),<br/>QualityCalculator (Radar Chart),<br/>OptimizationPanel]
        StateManagement[State Management<br/>TanStack Query + Context]
        APIClient[API Client<br/>Axios + Retry Logic]
    end

    subgraph "Backend - Flask / Python 3.11 [Target: sub-200ms processing]"
        APIGateway[API Gateway<br/>CORS + JWT + Rate Limiting]

        PromptController[Prompt Controller<br/>SQLAlchemy Pagination]
        AnalysisController[Analysis Controller<br/>Feature Extraction Pipeline]
        VariantController[Variant Controller<br/>Deterministic Generation]
        AnalyticsController[Analytics Controller<br/>SQL-Level Aggregations]

        QualityEngine[PES Quality Engine<br/>quality_calculator.py]
        NLPAnalyzer[NLP Analyzer<br/>feature_analyzer.py<br/>Bolt âš¡ Regex + spaCy]
        Validator[Meta-Architect Validator<br/>validator.py]
    end

    subgraph "Data Layer [High Consistency]"
        SQLite[(SQLite Database<br/>B-Tree Indexes on q_score,<br/>created_at, parent_id)]
    end

    Browser --> LibraryView
    Browser --> EditorView
    Browser --> AnalyzerView
    Browser --> ReportsView

    LibraryView --> APIClient
    EditorView --> APIClient
    AnalyzerView --> APIClient
    ReportsView --> APIClient

    APIClient --> APIGateway

    APIGateway --> PromptController
    APIGateway --> AnalysisController
    APIGateway --> VariantController
    APIGateway --> AnalyticsController

    AnalysisController --> QualityEngine
    AnalysisController --> NLPAnalyzer
    AnalysisController --> Validator

    PromptController --> SQLite
    AnalyticsController --> SQLite

    style Browser fill:#e1f5ff,stroke:#005a9c
    style SQLite fill:#fff4e1,stroke:#a67c00
    style QualityEngine fill:#ffe1f5,stroke:#9c005a
    style NLPAnalyzer fill:#ffe1f5,stroke:#9c005a
    style Validator fill:#e1ffe1,stroke:#009c00

%% Operational Metrics
%% 1. p95 Analysis Latency: <150ms
%% 2. p95 Variant Generation: <300ms
%% 3. Database Write Integrity: 100%
